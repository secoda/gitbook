---
hidden: true
noIndex: true
---

# Secoda AI API

This documentation provides information on how to use Secoda AI through the API for chat conversations and automatic description generation.

### Authentication

All API requests require authentication via a Bearer token:

```
Authorization: Bearer YOUR_API_KEY
```

You can generate an API key in your workspace settings. For more information on authentication, see our [authentication documentation](https://docs.secoda.co/secoda-api/authentication).

### 1. Chat with Secoda AI

Secoda AI provides a chat interface through the API that lets you interact with your data catalog.

#### Starting a Chat Session

**Endpoint:** `POST /ai/embedded_prompt/`

**Request Body:**

```json
{
  "prompt": "What tables contain customer information?",
  "parent": null,
  "user_generated": true,
  "persona_id": null,
  "web_search": false
}
```

**Parameters:**

* `prompt` (string, required): The text prompt you want to send to Secoda AI
* `parent` (string, optional): Parent prompt ID if this is a follow-up question in a conversation
* `user_generated` (boolean, optional): Whether this prompt was generated by a user (defaults to true)
* `persona_id` (string, optional): Use a specific AI persona ID if available
* `web_search` (boolean, optional): Enable web search capability (defaults to false)

**Response (201 Created):**

```json
{
  "id": "f83b7a6c-5d45-4bd2-9a3b-c1e3af6e20f8",
  "title": "Tables with customer information",
  "prompt": "What tables contain customer information?",
  "status": "PENDING",
  "response": null,
  "logs": null,
  "parent": null,
  "user": {
    "id": "user-id",
    "email": "user@example.com",
    "full_name": "User Name"
  },
  "created_at": "2023-10-15T10:30:45Z",
  "updated_at": "2023-10-15T10:30:45Z",
  "user_generated": true,
  "persona": null,
  "shared_globally": false,
  "children": []
}
```

#### Polling for Chat Response

After creating a chat prompt, the response will be generated asynchronously. You'll need to poll for the result using the prompt ID returned in the creation response.

**Endpoint:** `GET /ai/embedded_prompt/{prompt_id}/`

**Parameters:**

* `prompt_id` (path parameter): The ID of the prompt received from the create request

**Response (200 OK):**

```json
{
  "id": "f83b7a6c-5d45-4bd2-9a3b-c1e3af6e20f8",
  "title": "Tables with customer information",
  "prompt": "What tables contain customer information?",
  "status": "COMPLETED",
  "response": {
    "content": "I found several tables that contain customer information...",
    "references": [
      {
        "id": "table-id-1",
        "title": "customers",
        "type": "table"
      },
      {
        "id": "table-id-2", 
        "title": "customer_orders",
        "type": "table"
      }
    ]
  },
  "logs": null,
  "parent": null,
  "user": {
    "id": "user-id",
    "email": "user@example.com",
    "full_name": "User Name"
  },
  "created_at": "2023-10-15T10:30:45Z",
  "updated_at": "2023-10-15T10:31:30Z",
  "user_generated": true,
  "persona": null,
  "shared_globally": false,
  "children": []
}
```

The `status` field can be one of:

* `PENDING`: Request is queued
* `RUNNING`: AI is processing the request
* `COMPLETED`: Processing is complete and the response is available
* `FAILED`: Processing failed (check `logs` field for details)

#### Continuing a Conversation

To follow up on a previous response, create a new prompt with the `parent` field set to the ID of the previous prompt:

**Endpoint:** `POST /ai/embedded_prompt/`

**Request Body:**

```json
{
  "prompt": "Which one of these tables has the most records?",
  "parent": "f83b7a6c-5d45-4bd2-9a3b-c1e3af6e20f8",
  "user_generated": true
}
```

**Response:** Same format as the initial chat creation response.

#### Providing Feedback on Chat Response

**Endpoint:** `POST /ai/embedded_prompt/{prompt_id}/feedback/`

**Request Body:**

```json
{
  "is_helpful": true,
  "feedback": "This answer was very clear and useful."
}
```

**Parameters:**

* `is_helpful` (boolean, required): Whether the response was helpful
* `feedback` (string, optional): Additional feedback text

**Response (200 OK):** Empty response with 200 status code

### 2. AI-Generated Descriptions

Secoda AI can automatically generate descriptions for resources in your catalog.

#### Generating a Description for a Single Resource

**Endpoint:** `POST /bulk_generate_ai_metadata/generate/`

**Request Body:**

```json
{
  "field": "description",
  "entity_ids": ["1f5c76c3-e7a3-406f-b51e-7ba220244f1b"],
  "bulk_generate": false
}
```

**Parameters:**

* `field` (string, required): The field to generate content for. Use "description" for general descriptions or "definition" for technical definitions
* `entity_ids` (array of strings, required): Array containing the entity ID to generate a description for
* `bulk_generate` (boolean, optional): Set to false for single entity generation, which allows streaming the response (defaults to false)

**Response (201 Created):**

```json
{
  "job_id": "abcdef12-3456-7890-abcd-ef1234567890"
}
```

The `job_id` represents an `EmbeddedPrompt` ID for single entity generation.

#### Checking Description Generation Status

Use the embedded prompt endpoint to check the status of the description generation:

**Endpoint:** `GET /ai/embedded_prompt/{job_id}/`

**Parameters:**

* `job_id` (path parameter): The ID from the description generation response

**Response (200 OK):**

```json
{
  "id": "abcdef12-3456-7890-abcd-ef1234567890",
  "title": "Generating description for Customer Table",
  "prompt": "Write a concise and informative description",
  "status": "COMPLETED",
  "response": {
    "content": "This table contains customer information including personal details, contact information, and account status. It serves as the primary source of customer data for the CRM system.",
    "references": []
  },
  "logs": null,
  "parent": null,
  "user": {
    "id": "user-id",
    "email": "user@example.com",
    "full_name": "User Name"
  },
  "created_at": "2023-10-15T10:40:45Z",
  "updated_at": "2023-10-15T10:41:30Z",
  "user_generated": false,
  "persona": null,
  "shared_globally": false,
  "children": []
}
```

#### Generating Descriptions for Multiple Resources

To generate descriptions for multiple resources in a batch:

**Endpoint:** `POST /bulk_generate_ai_metadata/generate/`

**Request Body:**

```json
{
  "field": "description",
  "entity_ids": [
    "1f5c76c3-e7a3-406f-b51e-7ba220244f1b",
    "2d6e7503-8f05-4812-a5da-11863617bc62"
  ],
  "bulk_generate": true
}
```

**Parameters:**

* `field` (string, required): The field to generate content for ("description" or "definition")
* `entity_ids` (array of strings, required): Array of entity IDs to generate descriptions for
* `bulk_generate` (boolean, required): Set to true to process multiple entities as a background job

**Response (201 Created):**

```json
{
  "job_id": "98765432-1098-7654-321a-bc9876543210"
}
```

For bulk generation, the `job_id` represents a `BackgroundJob` ID.

#### Checking Bulk Description Generation Status

**Endpoint:** `GET /background_jobs/{job_id}/`

**Parameters:**

* `job_id` (path parameter): The ID from the bulk description generation response

**Response (200 OK):**

```json
{
  "id": "98765432-1098-7654-321a-bc9876543210",
  "title": "Bulk AI metadata generation for description",
  "status": "COMPLETED",
  "progress": 100,
  "created_at": "2023-10-15T11:00:00Z",
  "updated_at": "2023-10-15T11:02:30Z",
  "logs": "Successfully generated descriptions for 2 entities"
}
```

The status can be:

* `PENDING`: Job is queued
* `RUNNING`: Job is in progress
* `COMPLETED`: Job is complete
* `FAILED`: Job failed (check logs for details)

After the job completes, you can retrieve the updated entities with their new descriptions using the catalog API.

### Rate Limits

Secoda enforces a rate limit of 30 calls/min on PUT/PATCH/POST requests on all entity endpoints. If you exceed this limit, you'll receive a 429 (Too many requests) response.

### Error Handling

The API returns standard HTTP status codes:

* 200/201: Success
* 400: Bad request (check for validation errors in the response)
* 401: Unauthorized (invalid or missing API key)
* 403: Forbidden (insufficient permissions)
* 404: Resource not found
* 429: Too many requests (rate limit exceeded)
* 500: Internal server error

For more information on using the Secoda API, please refer to our [API documentation](https://docs.secoda.co/secoda-api).
